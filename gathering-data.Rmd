---
title: "gathering-data"
author: "Alexander Park"
date: "10/15/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(janitor)
require("knitr")
# opts_knit$set(root.dir = "~/Desktop/GOV_50/home-field-advantage/shiny-app")
```

```{r nfl}

# Create object nfl_scores_1966 that has all scores from NFL games from 1966-67
# to 2019-2020.

nfl_scores_1966 <- read_csv("data/spreadspoke_scores.csv")

# Create object avg_nfl_home_score that is the average score that home teams
# have had over the years.

avg_nfl_home_score <- nfl_scores_1966 %>%
  group_by(team_home) %>%
  summarize(avg_home = mean(score_home), .groups = "drop")

ggplot(avg_nfl_home_score, aes(team_home, avg_home)) + 
        geom_col(color = "white", fill = "dodgerblue") +
        theme(axis.text.x = element_text(angle = 90, 
                                         vjust = 0.5, 
                                         hjust = 0.3)) +
  labs(title = "Average Home Scores for All NFL Teams",
       subtitle = "From 1966-67 to 2019-20",
       x = "Team",
       y = "Average Home Score")

```

```{r nba}
# Create object nba_scores_2004 that has all scores from NFL games from 2004
# to February 2020.

nba_scores_2004 <- read_csv("data/nba2004/games.csv") %>%
  clean_names()

# Create object avg_nba_home_score that is the average score that home teams
# have had over the years.

avg_nba_home_score <- nba_scores_2004 %>%
  select(home_team_id, pts_home) %>%
  group_by(home_team_id) %>%
  summarize(avg_home = mean(pts_home, na.rm = TRUE), .groups = "drop")

ggplot(avg_nba_home_score, aes(home_team_id, avg_home)) + 
        geom_col(color = "white", fill = "dodgerblue") +
        theme(axis.text.x = element_text(angle = 90, 
                                         vjust = 0.5, 
                                         hjust = 0.3)) +
  labs(title = "Average Home Scores for All NBA Teams",
       subtitle = "From 2004 to Feb. 2020",
       x = "Team",
       y = "Average Home Score")
```

